<div class="row text-right sish-miga-de-pan">
    <div class="col-md-12 text-right">
        <ol class="breadcrumb float-sm-right sish-miga-de-pan">
            <li class="breadcrumb-item active">Configuración</li>
            <li class="breadcrumb-item"> {{'alertascalidad'|translate}}
            </li>
        </ol>
    </div>
</div>
<div class="container-fluid bg-white pt-5">
    <div class="row">
        <div class="col-md-12">
            <h2 class="sish-titulo-formulario text-center">
                {{'alertascalidad'|translate}}
            </h2>
        </div>
    </div>
    <div class="row">

        <div class="text-center form-group col-xl-12 col-lg-12 col-md-12 col-sm-12 " width="100%">
            <br>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" (change)="obtenerElementos(elemento)"
                    [(ngModel)]="elemento" name="elemento" id="elemento"
                    (click)="obtenerEstaciones()" 
                    value="1">
                <label class="form-check-label"  for="inlineRadio1">{{"Estaciones"|translate}}</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" (change)="obtenerElementos(elemento)"
                    [(ngModel)]="elemento" name="elemento" (click)="obtenerEmbalses()"  id="elemento" value="2">
                <label class="form-check-label" for="inlineRadio2">{{"embalses"|translate}}</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" (change)="obtenerElementos(elemento)"
                    [(ngModel)]="elemento" name="elemento" 
                    (click)="obtenerPozos()"
                     id="elemento" value="3">
                <label class="form-check-label" for="inlineRadio3">{{"pozos"|translate}}</label>
            </div>

            <p *ngIf="ngForm.submitted && elemento == 0" class="error">
                <sup>*</sup> {{ "elemento" | translate }} {{ "obligatoria" | translate }}
            </p>

        </div>

        <form class="sish-form" #ngForm="ngForm" [formGroup]="formularioFiltros" (ngSubmit)="filtrarCalidad(elemento)"
            novalidate>
            <div class="row" width="100%">

                <div class="col-xl-4 col-lg-4 col-md-4 col-sm-12">
              
                    <div class="form-group col-xl-12 col-lg-12 col-md-12 col-sm-12">
                    <label> {{ 'Nombre'|translate}}</label>

                    <ng-select2 name="idElemento"   [data]="listaElementosSeleccionados"
                    formControlName="idElemento"    [(ngModel)]="idelemento" [width]="'100%'"  [disabled]="!elemento"
                    (ngModelChange)="cambioDepartamento(departamentoSelected)" 
                    placeholder="{{ 'Seleccionar' | translate }} {{ 'elementos' | translate  }}...">
                        </ng-select2> 

                        <p *ngIf="ngForm.submitted && idElemento!.invalid" class="error">
                            <sup>*</sup> {{ "elemento" | translate }}   {{ "obligatoria" |  translate }}
                        </p>

                    </div>
         
                    
                   
                   </div>
                    <div class="col-xl-4 col-lg-4 col-md-4 col-sm-12">
                    <div class="form-group col-xl-12 col-lg-12 col-md-12 col-sm-12">
                        <label> {{ 'Parámetro'|translate}}</label>
                        <ng-select2 name="tipo" [data]="listParametro" 
                        (ngModelChange)="consultarParametro(idelemento,idParametro)"  [disabled]="!idelemento"
                            formControlName="idParametro" [width]="'100%'"
                            placeholder="{{'Seleccionar'|translate}} {{'parametro'|translate}}...">
                        </ng-select2>
                        <br>

                        <p *ngIf="ngForm.submitted && idParametro!.invalid" class="error">
                            <sup>*</sup> {{ "Parámetro" | translate }}   {{ "obligatoria" |  translate }}
                        </p>

                    </div>

                    <div class="form-group col-xl-12 col-lg-12 col-md-12 col-sm-12">
                        <label> {{'Estado'|translate}}  {{ ' observaciones'|translate}}</label>
                        <ng-select2 name="tipo" [data]="listValidaciones"   [disabled]="!idelemento"
                            formControlName="idEstadoObservacion" [width]="'100%'"
                            placeholder="{{'Seleccionar'|translate}} {{' estado'|translate}}...">
                        </ng-select2>
                        <br>
                    </div>
                   </div>
                    <div class="col-xl-4 col-lg-4 col-md-4 col-sm-12">


                   

                    <label style="color: #00b0f0">{{ 'Periodo' | translate }}</label>
                    <br>

                    <div class="form-group col-xl-12 col-lg-12 col-md-12 col-sm-12">
                        <div class="form-group col-xl-12 col-lg-12 col-md-12 col-sm-12">
                            <label style="color: #00b0f0">{{'Desde'|translate}} </label>
                            <input type="date" class="form-control"  [disabled]="!idelemento" formControlName="fechaInicio" [max]=fechaActual
                                name="fechaInicio" />
                            <p *ngIf="ngForm.submitted && fechaInicio!.invalid" class="error">
                                <sup>*</sup> {{ "fecha" | translate }} {{ "inicio" | translate }} {{ "obligatoria" |
                                translate }}
                            </p>


                        </div>
                        <div class="form-group col-xl-12 col-lg-12 col-md-12 col-sm-12">
                            <label style="color: #00b0f0">{{'Hasta'|translate}} </label>
                            <input type="date" class="form-control"   [disabled]="!idelemento" [max]=fechaActual formControlName="fechaFin"
                                name="fechaFin" />

                            <p *ngIf="ngForm.submitted && fechaFin!.invalid" class="error">
                                <sup>*</sup> {{ "fecha" | translate }} {{ "fin" | translate }} {{ "obligatoria" |
                                translate }}
                            </p>

                        </div>
                    </div>
 

                </div>
              
            
            

                <!--BOTONES-->
                <div class="row">
                    <div class="form-group col-xl-12 col-lg-6 col-sm-12">
                        <div class="btn-group mr-2" role="group" aria-label="First group">
                            <button type="submit" class="sish-boton-confirmar">
                                {{ 'Validar calidad' | translate }}
                            </button>
                        </div>
                      
                        <div class="btn-group mr-2" role="group" aria-label="Second group" >
                            <button type="button" class="sish-boton-cancelar" (click)="resetfiltro()">
                                {{ 'Botones.Cancelar' | translate }}
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </form>

    </div>
    <app-datatable [name]="'ResultadoConsulta'" [datos]="datosFilter" [opciones]="columnas"
        [id]="'idObservacionXElemento'" [columnaEstado]="'activo'" [condicionEstado]="'No'"
        [transformaciones]="{ activo: { S: 'Sí', N: 'No' }, nombre: {'Administrador 1': 'W'}}"
        [consultarRegistros]="false" [editarRegistros]="false" [eliminarRegistros]="false"
        [cambiarEstadoRegistros]="false" (accion)="accionRegistro($event)" [verFiltros]="false" [verColumnas]="true"
        [crear]="false" [copiar]="true" [imprimir]="true" [excel]="true" [botones]="botones2"
        [seleccionarRegistro]="false" (listaSelect)="lista($event)">
    </app-datatable>



    <!-- MODAL -->
  

    <div class="invisible">
        <button type="button" #ModalCalidad class="invisible" data-toggle="modal" data-target="#ModalCalidad"></button>
    </div>


    <div id="ModalCalidad" class="modal fade" role="dialog">
        <div class="modal-dialog" role="document">

            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">{{ "detalle" | translate }}</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
  
                            <form class="sish-form" #ngForm2="ngForm" [formGroup]="formularioCalidad" >
                         
                            <div class="row" width="100%">

                            <!-- <div class="form-group col-xl-3 col-lg-4 col-md-4 col-sm-12">
                                <label> {{ "origen" | translate }}</label>
                                {{OrigenObservacion}}
                            </div> -->

                            <div class="form-group col-xl-3 col-lg-4 col-md-4 col-sm-12">
                                <label> {{ "valor" | translate }}</label>
                                {{valorObservacion}}
                            </div>
                            <div class="form-group col-xl-3 col-lg-4 col-md-4 col-sm-12">
                                <label> {{ "fecha" | translate }}</label>
                                {{FechaObservacion | date: 'dd/MM/yyyy' }}

                            </div>
                            <div class="form-group col-xl-4 col-lg-4 col-md-4 col-sm-12">
                                <label> {{ "Flag" | translate }}</label>
                                {{estadoObservacion}}
                            </div> 

                            <div class="form-group col-xl-12 col-lg-4 col-md-4 col-sm-12">
                                <label> {{ "observaciones" | translate }}</label>
                                <input type="text" [(ngModel)]="observacionesCalidad" 
                                formControlName="observacionesCalidad" 
                                class="form-control" />
                            </div>
 
                            <p *ngIf="ngForm2.submitted && observacionCalidad!.invalid" class="error">
                                <sup>*</sup> {{ "observaciones" | translate }} {{ "obligatoria" |
                                translate }}
                            </p>

                        </div>
                        
                    
                        <div class="modal-footer">
                            <button type="submit" class="sish-boton-confirmar"  (click)="ValidarCalidad(265)" > 
                                Validado
                            </button>
                            <button type="submit" class="sish-boton-cancelar" (click)="ValidarCalidad(841)">
                                Rechazado 
                            </button> 
                        </div>

                    </form>
                </div>
                
            </div>
        </div>
    </div>


    <button id="validarBtn1"    style="visibility: hidden;"  type="button" class="btn btn-primary" data-toggle="modal"
data-target="#validar1" >             
</button>
<div class="modal fade " id="validar1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl verybigmodal"  style=" display: block; min-width:100vh !important;" role="document">
        <div class="modal-content">
            <div class="modal-header">

              <h5 class="modal-title" id="exampleModalLabel">Validar Criterios de calidad </h5>
              <button type="button"  class="close" data-dismiss="modal"   aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
  
       
          

               
                    <app-datatable [datos]="listValidaObervacion" [opciones]="columnasValidar" 
                    [transformaciones]="false"  [verFilrtos]="false" 
                       [editarRegistros]="false"
                        [cambiarEstadoRegistros]="false" (accion)="false" 
                        [crear]="false" [copiar]="false" [excel]="false" [verFiltros]="false"
                        [verRegistros]="false"  [ver]="false"   [editar]="false" 
                        [cambiarEstadoRegistros]="false"
                         [verFiltros]="false"  [acciones]="false" 
                        [ver]="false"  [imprimir]="false" [excel]="false" 
                        [seleccionarRegistro]="false" [consultarRegistros]="false" 
                        [editarRegistros]="false" [eliminarRegistros]="false"
                         [verColumnas]="false" 
                        ></app-datatable>
          

        
        </div>
        <div class="modal-footer">
            <button type="button" class="sish-boton-cancelar"     data-dismiss="modal">Regresar</button>
        </div>  
    </div>
      </div>
    </div>