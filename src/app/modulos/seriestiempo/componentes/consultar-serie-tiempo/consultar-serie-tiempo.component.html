<div class="row text-right sish-miga-de-pan">
    <div class="col-md-12 text-right">
        <ol class="breadcrumb float-sm-right sish-miga-de-pan">
            <li class="breadcrumb-item active">Configuración</li>
            <li class="breadcrumb-item">{{'serietiempo'|translate}}
            </li>
        </ol>
    </div>
</div>
<div class="container-fluid bg-white pt-5">
    <div class="row">
        <div class="col-md-12">
            <h2 class="sish-titulo-formulario text-center">{{'Serie de tiempo'|translate}}
            </h2>
        </div>
    </div>
    <div class="row">

        <div class="text-center form-group col-xl-12 col-lg-12 col-md-12 col-sm-12 " width="100%">
            <br>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" (change)="obtenerElementos(elemento)" [(ngModel)]="elemento" name="elemento" id="elemento" value="466">
                <label class="form-check-label" for="inlineRadio1">{{"Estaciones"|translate}}</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" (change)="obtenerElementos(elemento)" [(ngModel)]="elemento" name="elemento" id="elemento" value="467">
                <label class="form-check-label" for="inlineRadio2">{{"embalses"|translate}}</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" (change)="obtenerElementos(elemento)" [(ngModel)]="elemento" name="elemento" id="elemento" value="468">
                <label class="form-check-label" for="inlineRadio3">{{"pozos"|translate}}</label>
            </div>

        </div>

        <form class="sish-form" #ngForm="ngForm" [formGroup]="formularioFiltros" (ngSubmit)="filtrar(elemento)" novalidate>
            <div class="row" width="100%">

                <div class="col-xl-4 col-lg-4 col-md-4 col-sm-12">
                    <hr />
                    <div class="btn-group mr-2" role="group" aria-label="First group" *ngIf="elemento == 466">
                        <button type="button" class="btn btn-primary" data-toggle="modal" (click)="obtenerEstaciones()" data-target="#ModalEstaciones"> 
             {{ 'Agregar' | translate }}  {{" estaciones"|translate}}
             </button>
                    </div>
                    <div class="btn-group mr-2" role="group" aria-label="First group" *ngIf="elemento == 467">
                        <button type="button" class="btn btn-primary" data-toggle="modal" (click)="obtenerEmbalses()" data-target="#ModalEmbalses"> 
             {{ 'Agregar' | translate }}  {{" embalses"|translate}}
             </button>
                    </div>
                    <div class="btn-group mr-2" role="group" aria-label="First group" *ngIf="elemento == 468">
                        <button type="button" class="btn btn-primary" data-toggle="modal" (click)="obtenerPozos()" data-target="#ModalPozos"> 
             {{ 'Agregar' | translate }} {{" pozos"|translate}}
             </button>
                    </div>
                    <br>
                    <table class="table">
                        <tr>
                            <tr *ngFor="let dato of listaBusqueda">
                                <th scope="row" *ngIf="elemento ==466"> {{dato.idEstacion}}</th>
                                <th scope="row" *ngIf="elemento ==466"> {{dato.estacion}}</th>
                                <th scope="row" *ngIf="elemento ==467"> {{dato.idEmbalse}}</th>
                                <th scope="row" *ngIf="elemento ==467"> {{dato.embalse}}</th>
                                <th scope="row" *ngIf="elemento ==468"> {{dato.idPozo}}</th>
                                <th scope="row" *ngIf="elemento ==468"> {{dato.pozo}}</th>
                                <th scope="row">
                                    <a class="sish-boton-rojo" title="eliminar">
                                        <em class="fas fa-trash-alt" (click)="eliminarLista(dato)"></em></a>
                                </th>
                            </tr>
                    </table>

                    <p *ngIf="ngForm.submitted && listaBusqueda.length == 0" class="error">
                        <sup>*</sup> {{'DebeingresarunElemento'|translate}}
                    </p>

                


                </div>

             

            
       
                  
                    <div class="col-xl-4 col-lg-4 col-md-4 col-sm-12"  *ngIf="listaBusqueda.length > 0"  >
                        <font color="#2196f3"> {{ 'Parámetro'|translate}}</font>
                        <ng-select2 name="tipo" [data]="listParametro" [(ngModel)]="parametro" formControlName="idParametro" [width]="'100%'" placeholder="{{'Seleccionar'|translate}} {{'parametro'|translate}}...">
                        </ng-select2>
                        <br>
                        <a class="sish-boton-verde" title="Agregar">
                            <em class="fas fa-plus-circle" (click)="agregarlistaParametros(parametro)"> </em>
                        </a>

                        <p *ngIf="ngForm.submitted && listParametroXElemento.length == 0" class="error">
                            <sup>*</sup> {{'DebeingresarunParametro'|translate}}
                        </p>
                    </div>
                    <div class="col-xl-4 col-lg-4 col-md-4 col-sm-12"  *ngIf="listaBusqueda.length > 0"   >
                        <table class="table">
                            <tr>
                                <tr *ngFor="let dato of listParametroXElemento">
                                    <ng-select2 name="tipo" [data]="listParametro" (ngModel)="dato.id" formControlName="idParametro" [disabled]="true" [width]="'100%'">
                                    </ng-select2>
                                    <th scope="row">
                                        <a class="sish-boton-rojo" title="eliminar">
                                            <em class="fas fa-trash-alt" (click)="eliminarListaParametros(dato)"></em></a>
                                    </th>
                                </tr>
                        </table>
    
    
    
                    </div>
                    <div class="col-xl-4 col-lg-4 col-md-4 col-sm-12"  *ngIf="listParametroXElemento.length > 0" >
                        <div class="form-group col-xl-12 col-lg-12 col-md-12 col-sm-12">
                            <label> {{ 'Consecutivo'|translate}}</label>
                            <ng-select2 name="tipo" [data]="listaSeries" [(ngModel)]="consecutivo" formControlName="idConceptivo" [width]="'100%'" placeholder="{{'Seleccionar'|translate}} {{' consecutivo'|translate}}...">
                            </ng-select2>
                            <br>
                        </div>
                  
                    </div>
               
              
                <!--BOTONES-->
                <div class="row">
                    <div class="form-group col-xl-12 col-lg-6 col-sm-12">
                        <div class="btn-group mr-2" role="group" aria-label="First group">
                            <button type="submit" class="sish-boton-confirmar"> 
                {{ 'Botones.Filtrar' | translate }}
                </button>
                        </div>
                        <div class="btn-group mr-2" role="group" aria-label="Second group">
                            <button type="button" class="sish-boton-cancelar" (click)="resetfiltro()" >
                {{ 'Botones.Cancelar' | translate }}
                </button>
                        </div>

                    </div>
                </div>
            </div>
        </form>

    </div>
    <div class="container" *ngIf="datosFilter.length > 0">
        <div class="row">

        <div class="col-xl-10 col-lg-10 col-md-10 col-sm-10">

            <div id="chart">
              <apx-chart
                [series]="chartOptions.series"
                [chart]="chartOptions.chart"
                [xaxis]="chartOptions.xaxis"
                [markers]="chartOptions.markers"
                [stroke]="chartOptions.stroke"
                [yaxis]="chartOptions.yaxis"
                [dataLabels]="chartOptions.dataLabels"
                [title]="chartOptions.title"
                [fill]="chartOptions.fill"
                [tooltip]="chartOptions.tooltip"
                [legend]="chartOptions.legend"
              ></apx-chart>
            </div>
            <br>

        </div>
        <div class="col-xl-2 col-lg-2 col-md-2 col-sm-2 ">
            <div class="col-xl-12">
              <label>Promedio = {{promedio}} </label>
              <label> </label>
          </div>
          <div class="col-xl-12">
            <label>Media = {{median}} </label>
            <label> </label>
        </div>
        <div class="col-xl-12">
            <label>Mediana = {{mediana}} </label>
            <label> </label>
        </div>
        <div class="col-xl-12">
            <label>Moda = {{moda}} </label>
            <label> </label>
        </div>
          </div>
    </div>
     </div>
    <div class="container" *ngIf="Anual.length > 0">
        <div class="row">

          

            <div class="col">
                <ngx-charts-bar-vertical-2d [view]="viewAnual" scheme="aqua" [results]="Anual" [gradient]="gradient" [xAxis]="showXAxis" [yAxis]="showYAxis" [legend]="showLegend" [showXAxisLabel]="showXAxisLabel" [showYAxisLabel]="showYAxisLabel" [legendPosition]="legendPosition"
                    [showGridLines]=false [yAxisLabel]="yAxisLabelAnual">
                </ngx-charts-bar-vertical-2d>

            </div>
            <div class="col" *ngIf="Mensual.length > 0">
                <ngx-charts-bar-vertical-2d [view]="viewMensual" scheme="neons" [results]="Mensual" [gradient]="gradient" [xAxis]="showXAxis" [yAxis]="showYAxis" [legend]="showLegend" [showXAxisLabel]="showXAxisLabel" [showYAxisLabel]="showYAxisLabel" [legendPosition]="legendPosition"
                    [showGridLines]=false [yAxisLabel]="yAxisLabelMensual">
                </ngx-charts-bar-vertical-2d>
            </div>
        </div>
    </div>

    <app-datatable [name]="'ResultadoConsulta'" [datos]="datosFilter" [opciones]="columnas" [id]="'idSerieTiempoElemento'" 
        [rutaGeneral]="rutaGeneral" [rutaConsulta]="rutaConsulta" 
        [rutaEdicion]="rutaEdicion" [columnaEstado]="'activo'" [condicionEstado]="'No'"
        [transformaciones]="{ activo: { S: 'Sí', N: 'No' }, nombre: {'Administrador 1': 'W'}}" 
        [consultarRegistros]="false" [editarRegistros]="false" [eliminarRegistros]="false" 
        [cambiarEstadoRegistros]="false" (accion)="accionRegistro($event)" 
        [verColumnas]="validarPermiso('ConsultarSerieTiempo')" [verFiltros]="false" [crear]="validarPermiso('CrearSerieTiempo')" 
        [copiar]="validarPermiso('ConsultarSerieTiempo')" [imprimir]="validarPermiso('ConsultarSerieTiempo')" 
        [excel]="validarPermiso('ConsultarSerieTiempo')" (accionGeneral)="accionGeneral($event)"
        [seleccionarRegistro]="false" (listaSelect)="lista($event)">
    </app-datatable>

    <!-- MODAL -->
    <div id="ModalEstaciones" class="modal fade" role="dialog">
        <div class="modal-dialog modal-lg">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">{{ "Estaciones" | translate }}</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    <app-datatable [datos]="datosFilterEstaciones" [opciones]="columnasEstaciones" [id]="'idEstacion'" [columnaEstado]="'false'" [condicionEstado]="'No'" [transformaciones]="{ activo: { S: 'Sí', N: 'No' }, nombre: {'Administrador 1': 'W'}}" [consultarRegistros]="false"
                        [editarRegistros]="false" [eliminarRegistros]="false" [cambiarEstadoRegistros]="false" (accion)="accionRegistroModal($event)" [verFiltros]="true" [verColumnas]="false" [crear]="false" [copiar]="false" [imprimir]="false" [excel]="false"
                        [botones]="botones"
                        [seleccionarRegistro]="false"
                        ></app-datatable>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" id="salir" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div id="ModalEmbalses" class="modal fade" role="dialog">
        <div class="modal-dialog modal-lg">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">{{ "Embalses" | translate }}</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    <app-datatable [datos]="datosFilterEmbalses" [opciones]="columnasEmbalses" [id]="'idEmbalse'" [columnaEstado]="'false'" [condicionEstado]="'No'" [transformaciones]="{ activo: { S: 'Sí', N: 'No' }, nombre: {'Administrador 1': 'W'}}" [consultarRegistros]="false"
                        [editarRegistros]="false" [eliminarRegistros]="false" [cambiarEstadoRegistros]="false" (accion)="accionRegistroModal($event)" [verFiltros]="true" [verColumnas]="false" [crear]="false" [copiar]="false" [imprimir]="false" [excel]="false"
                        [botones]="botones"
                        [seleccionarRegistro]="false">
                    </app-datatable>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div id="ModalPozos" class="modal fade" role="dialog">
        <div class="modal-dialog modal-lg">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">{{ "pozos" | translate }}</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    <app-datatable [datos]="datosFilterPozos" [opciones]="columnasPozos" [id]="'idPozo'" [columnaEstado]="'false'" [condicionEstado]="'No'" [transformaciones]="{ activo: { S: 'Sí', N: 'No' }, nombre: {'Administrador 1': 'W'}}" [consultarRegistros]="false"
                        [editarRegistros]="false" [eliminarRegistros]="false" [cambiarEstadoRegistros]="false" (accion)="accionRegistroModal($event)" [verFiltros]="true" [verColumnas]="false" [crear]="false" [copiar]="false" [imprimir]="false" [excel]="false"
                        [botones]="botones"
                        [seleccionarRegistro]="false"></app-datatable>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>